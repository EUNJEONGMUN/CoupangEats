# coupangEatsA-test-server-haena

Rising Test

## 2022-03-19 진행상황

  - 기획서 작성
  - EC2 인스턴스 구축
  - RDS 데이터베이스 구축
  - localhost:9009 포트 연결 확인
  - ERD 설계 완료
    - https://aquerytool.com/aquerymain/index/?rurl=e4a2c069-adcf-423d-9e44-11c53c677c0b
    - passward : a74vd2

## 2022-03-20 진행상황
      
### API 리스트 관련
- 회원가입 API 구현
- 로그인 API 구현
- 홈 화면 조회 API 구현 (거리 관련 제외)
<br>
- validation 구현
- 인가 구현
- 

### 기타
- DB 테이블 생성
- ERD 수정
- RESTful API 리스트업
  - https://docs.google.com/spreadsheets/d/1VIkuCFoaXgTUkJoDqHE50YlTO9RZGANg/edit?usp=sharing&ouid=108228008875958634623&rtpof=true&sd=true
- 더미데이터 추가

### TODO
- 회원가입 시, 비밀번호 정규식 심화 구현
- 홈 화면 조회 시 거리 관련 정보 구현

## 2022-03-21 진행상황

### API 리스트 관련

- 홈화면 API 수정 
  - 정렬, 필터 기능 추가
- 가게 상세화면 조회 API 구현
  - storeIdx Params -> String
  - storeIdx 존재 하지 않을 경우 예외처리 추가


### 트러블 슈팅
```Optional int parameter 'storeIdx' is present but cannot be translated into a null value due to being declared as a primitive type.```
- storeIdx를 RequestParam으로 받을 때 int일 경우 null 값으로 처리할 수 없기 때문에 발생한 에러
    - -> String 값으로 받아 null 값을 확인한 후, 아닐 경우 int로 바꾸어 진행할 수 있게 하였다.
    - **22-03-22 수정**
      - requestParam 값에 default 값을 설정해주면 int 형으로 받아도 해결 가능하였다.
      - `@RequstParam(value='', required='false', defaultValue="0")`

### 위클리 스크럼 내용
#### 작업한 부분 공유
#### 구팽 
  - 필요한 아이템은 다 정의를 해둔 상태. 가게 리스트 화면은 아직 데이터가 없어 연결하지 않음.
  - <img src="./READMEImg/Android1.png" width="100">
    - <img src="./READMEImg/Android2.png" width="100">
    - <img src="./READMEImg/Android3.png" width="100">
    - <img src="./READMEImg/Android4.png" width="100">
    - <img src="./READMEImg/Android5.png" width="100">
    - <img src="./READMEImg/Android6.png" width="100">

#### 해나
- EC2 인스턴스 구축
- RDS 데이터베이스 구축
- ERD 설계 완료
- RESTful API 리스트업

- API 관련
  - 회원가입 API 구현
  - 로그인 API 구현
  - 홈 화면 조회 API 구현 (거리 관련 제외)
  - 가게 상세화면 조회 API 구현  
  <br>
#### 궁금한 점 공유
  - 사장님 입장에서의 API도 만들어야 할까? -> 사장님 앱이 따로 있으므로, 더미 데이터만 집어 넣는 쪽으로 하기로 함.
  - 회원가입 시, 사용자의 위치 정보를 쿼리 스트링으로 보내도 되는가? -> 회원 가입 시에는 필요 없을 것 같음.
  - 로그인 시 위치정보를 Response 해주어야 하는가? -> 로그인 시에 위치 정보가, 위치 권한을 동의한 위치로 설정되므로 안 해주어도 될 것 같다.
  - 가게 카테고리가 일대일이 아닌 일대 다이기 때문에 테이블을 따로 해주어야 할 것 같다.
  - 가게 매장 정보, 원산지 정보 등을 저장 하는 것은 DB에서 항목별로 나누어 관리해야 하는가? -> 피드백 시간에 여쭤 보기로 함.
  - 가격에 원 단위를 붙이는 것은 서버에서 해주어야 하는가? -> int형태로 넘겨주면 클라이언트에서 작업하기로 함
  - 매장과 사용자와의 거리 계산 -> 매장의 위도, 경도 정보를 넘겨주면 클라이언트에서 작업해주기로 함.


## 2022-03-22 진행상황
- 메뉴 상세화면 조회 API 구현
- 홈화면 조회 API에 카테고리 별 조회 추가
- 집 주소, 회사, 기타 주소 관리 API 구현
- 기타 주소 추가 API 구현
- 주소 조회 API 구현
- build 시도 ->  `gradle build daemon disappeared unexpectedly (it may have been killed or may have crashed)`에러 발생 -> 내일 다시 시도

### 서버 피드백 내용
- API 구축 순서는 클라이언트와 상의해서 클라이언트의 진행 상황에 맞게 맞추어 나가는 것이 좋다.
- 서버 빌드 후 API 테스트를 해보는 것을 추천한다.
- API 명세서에 캡쳐 화면 추가
- 가게 영업시간 같은 경우는 테이블을 따로 만들어야 한다.


## 2022-03-23 진행상황
- 회원 가입 시 필요한 입력값 정규식 수정, 보완
- 3개 이상 연속되거나 동일한 문자/숫자 제외 구현
- 가게 상세 화면 API에 포토 리뷰 추가

- build 성공
  - GET메소드는 성공했지만, POST메소드에서 `Request method 'GET' not supported` 에러 발생

## 2022-03-24 진행상황
- 배달 카드 담기 API 구현
- 배탁 카트 새로 담기 API 구현
- 주소 관련 API DB 수정
  - 사용자 집, 회사 관련 정보를 기타 주소지 정보와 함게 UserAddress 테이블에 담기로 함.

## 2022-03-25 진행상황
- 홈화면 API 수정
- 가게 상세 화면 API 수정
- 주소 관련 API 수정
- 배달 카트 수정 API 구현

## 2022-03-26 진행상황
- 홈화면 API 수정
  - 카테고리 추가
  - 배달비, 쿠폰 상위 한 개만 선택
- 가게 상세 화면 API 수정
  - 사용자와 가게 간의 거리 추가
  - 메뉴별 주문많음, 리뷰 최고 변수 추가

- 주문하기 API 구현
- 주문 취소 API 구현
- 주문 목록 조회 API 구현
  
<br>  

- 상세 변동사항
```
1. 메뉴 상세 화면 조회 API에서 response 값에 menuIdx 추가
2. 가게 상세 화면 조회 API response 값에 가게 주소지 정보 추가
    2-1. 쿠폰 정보에서 할인 가격, 최소 주문 금액, 종료 시간 -> 출력 format String으로 바꿈
    2-2. 배달비 정보에서 주문 가격, 배달비 -> 출력 format String으로 바꿈
    2-3. 메뉴마다 isManyOrder(주문많음), isManyReview(리뷰최고) 변수 추가
        2-3-1. 주문 많음의 기준 : 가게 전체 주문량의 50%이상
        2-3-2. 리뷰 최고의 기준 : 가게 전체 메뉴 리뷰 좋아요 수의 50%이상
    2-4. 로그인을 한 사용자가 가게를 즐겨찾기 등록한 경우를 나타내기 위한 isFavoriteStore 변수 추가
    2-5. 홈화면과 마찬가지로 쿼리스트링으로 현재 위치의 경도, 위도를 받아와야 함.
```

## 2022-03-27 진행상황
- 즐겨찾기 관련 API 구현
- 가게별 리뷰 조회 API 구현
- 주문 목록 조회 API 수정
  - 메뉴 이름 변수 추가
- 할인 쿠폰 조회 API 구현
- 할인 쿠폰 받기 API 구현
- 가게 상세 정보 조회 API 수정 : 사용자가 쿠폰을 다운 받았는지 여부를 알 수 있도록 하는 변수 추가

### 위클리 스크럼 내용
#### 작업한 부분 공유
#### 구팽
- 가게 상세 화면 작업중
- 지도와 회원가입 관련은 완료함.
- 작업이 조금 늦어지고 있는 것 같아 속도를 낼 필요가 있다고 생각함.

#### 해나
- 배달 카트 관련 API 구현
- 주문 관련 API 구현
- 즐겨 찾기 API 구현
- 할인 쿠폰 관련 API 구현 
- 세부적인 사항은 클라이언트와 상의하면서 조금씩 수정해 나가야 함.

#### 궁금한 점 공유
- 배달 카트 화면에서 사용자의 위치 정보는 어떻게 해야 하는가? -> 서버에서 사용자의 현재 위치를 Response해주기로 함.
- 배달 카트 화면에서 쿠폰 정보를 어떻게 해야 하는가? -> 기존에 구현해 놓은 쿠폰 조회 API를 사용하기로 함. 적용 가능한 쿠폰 여부는 클라이언트에서 처리하기로 함. 단, 계산을 위해 String 형이 아닌 int형으로 반환하기로 함.
- 배달 카트에서 함께 주문하면 좋을 메뉴는 어떻게 해야 하는가? -> 잘 보니 옵션이 없는 메뉴 10개를 내보내는 것 같다. 이는 클라이언트에서 처리 가능함.
- 카트에서 메뉴 삭제 시 수량은 기존에 있던 수량을 그대로 담아 Request 하기로 함.

- 스크럼 이외에도 계속 소통하면서 작업하고 있음.

## 2022-03-28 진행상황
- 배달 카트 조회 API 구현
- 가게별 리뷰 조회 API 수정
  - 정렬을 위한 createdAt 추가
  - 필터를 위한 isPhotoReview 추가

- 가게 상세 화면, 메뉴 상세화면 -> 이미지 1개 이상
- 가게 상세 화면에서 리뷰 최다, 주문 많음 코드 수정

- S3 이용하여 이미지 업로드 시도
- 작성한 리뷰 조회 API 구현
- 가게 상세 화면 API 수정 : 메뉴 이미지가 없을 때 반환되는 값이 없어 오류가 났음 -> 반환 되는 값이 없을 경우에는 null 반환하도록 함.
- 리뷰 작성 API 구현 -> 사진 다중 업로드 가능
- 리뷰 수정 API 구현 중 -> 사진 업로드 방식 고민.

- 더미데이터 추가 삽입
- 메뉴 이미지 추가

## 2022-03-29 진행상황
- 홈화면 API 쿠폰 존재 여부 쿼리 수정
- 재주문하기 API 구현
- 리뷰 수정 API 구현

### 서버 피드백 내용
- 데이터가 많아지면 클라이언트에서 처리하는 것이 힘드므로, 서버에서 처리 하는 것이 좋다.
- 수정과 삭제 API를 분리 하는 것이 좋을 것 같다.
- 소셜로그인이나 문자 전송 API도 구현해 보는 것을 추천한다.
- 리뷰 수정 시 사진 업로드의 경우 새로 다시 올리는 방향으로 생각하면 된다.

### 2022-03-30 진행상황
- 카트 수정/삭제 API 분리 -> 카트 삭제 API 구현